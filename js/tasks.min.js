function createTask(t){var a="task"+t.id,e=$("<input />").attr({id:a+"-checkbox",type:"checkbox",checked:"true"==t.status?!0:!1}).prop("disabled","true"==t.status?!0:!1).addClass("task-ctrl");e.click(function(){var a=$(this);$.ajax({type:"POST",url:"/upd",data:{taskid:t.id},success:function(){a.prop("disabled",!0)},error:function(){a.prop("checked",a.is(":checked")?!1:!0)}})});var d=$("<span />").attr("id",a+"-text").addClass("task-ctrl task-span").text(t.text),s=$("<button />").attr("id",a+"-del").addClass("task-ctrl").append($("<img>").attr("src",inactiveIcon));s.hover(function(){$(this).children().attr("src",activeIcon)},function(){$(this).children().attr("src",inactiveIcon)}),s.click(function(){var t=$(this).attr("id").replace("task","").replace("-del","");$.ajax({type:"POST",url:"/del",data:{taskid:t},success:function(){$("#task-"+t).remove()}})}),$("#tasks-ul").append($("<li />").addClass("task-li").attr("id","task-"+t.id).append(e,d,s))}function task(t,a,e){return{id:t,text:a,status:e}}function toggleAddTaskFormAndLink(){$("#add-task-form").toggle(),$("#add-task-link").toggle()}function resetAddTaskText(){$("#add-task-text").val(addTaskText)}var addTaskLinkText="+ Add task",addTaskText="Input task text here",addTaskSaveText="Save",addTaskCancelText="Cancel",inactiveIcon="img/del-inactive.png",activeIcon="img/del-active.png";$(document).ready(function(){$.ajax({type:"GET",url:"/get",success:function(t){for(var a=t.tasks,e=0;e<a.length;e++)createTask(a[e])}}),$("#add-task-link").text(addTaskLinkText).click(function(){toggleAddTaskFormAndLink()}),resetAddTaskText(),$("#add-task-text").click(function(){$(this).val()==addTaskText?$(this).val(""):""}),$("#add-task-save-btn").text(addTaskSaveText).click(function(){var t=$("#add-task-text").val();$.ajax({type:"POST",url:"/add",data:{tasktext:t},success:function(a){toggleAddTaskFormAndLink(),resetAddTaskText(),createTask(task(a.taskid,t,0))}})}),$("#add-task-cancel-btn").text(addTaskCancelText).click(function(){toggleAddTaskFormAndLink(),resetAddTaskText()})});